<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Bootstrap Table Examples</title>


	<link rel="stylesheet" href="../css/bootstrap.min.css" />
	<link rel="stylesheet" href="../css/bootstrap-table.css" />
	<link rel="stylesheet" href="../css/bootstrap-datetimepicker.css" />
	
	
	<script src="../js/jquery.js" type="text/javascript"></script>
	<!--<script src="https://www.mshuoke.com/html/js/jquery-1.7.2.min.js" type="text/javascript"></script>-->
    <script src="../js/bootstrap.min.js"></script>

	<script src="../js/bootstrap-table.min.js" type="text/javascript"></script>

	

	

	
	<script src="../js/bootstrap-datetimepicker.min.js" type="text/javascript"></script>
	
	
	
	<script src="../js/jquery.autocomplete.js" type="text/javascript"></script>
	
	
	<script src="https://cdn.bootcss.com/react/15.5.4/react.js"></script>
	
	<script src="https://cdn.bootcss.com/react/15.5.4/react-dom.js"></script>

	<script src="../js/url.js"></script>
	<script src="../js/myself-function/main.js"></script>
	
	<script src="../js/mock.js" type="text/javascript"></script>
	<script src="../js/PerfectData_upload-darren.js"></script>
	<script src="../js/jquery.validate.min.js" type="text/javascript"></script>

	
	<style>
		#forlogin { display:none; background:#ffffff;  overflow:hidden; height:100%; }
		*{ padding:0; margin:0; }
		ul li { list-style-type:none; }
		#forlogin ul { width:100%; overflow:hidden; margin-top:20px;  }
		#forlogin ul li { float:left; width:50%; }
		
		#forlogin ul li.first {width:60px; text-align:right; }
		#forlogin ul.industry{ margin-top:30px; }
		#forlogin ul.industry li {  }
		#forlogin ul.industry li input { float:left;  }
		#forlogin ul.high li.high-n   { text-align:left;  }
		
		#forlogin ul li.last  { padding-left:20px;  }
		#forlogin ul li .running { float:left;  width:70px; height:20px; }
		#forlogin ul li .outOff { float:left; width:70px; height:20px; }
		#forlogin ul li .outOff  span { float:left; margin-top:2px; margin-left:5px;  display:inline-table; }
		#forlogin ul li .running  span { float:left; margin-top:2px;    margin-left:5px;   display:inline-table; }
		#forlogin ul li .outOff input { float:left; }
		#forlogin ul li .running input { float:left; }
		#forlogin ul.descening li input { float:left; }
		#addIndustry  { margin-top:20px;  margin-bottom:100px; }
		#toolbar { width:120px; } 
		.fixed-table-toolbar { width:120px; }
		.industrySetting { width:100%; overflow:hidden; margin-top:20px; margin-bottom:0; }
		.industrySetting li { float:left; }
		.search-box { overflow:hidden; padding-bottom:3px; }
		.search-box  .fixed-table-toolbar { float:left; }
		.search-box  #toolbar {margin-left:20px; float:left; margin-top:10px; margin-bottom:10px; }
		.bootstrap-table { margin-top:15px; }
		
		
		@media (min-width: 100px) {
			.container {
				width: auto;
			}
		}
		.fixed-table-toolbar { width:100%; }
		
		.pull-right1.search { margin-top:0; float:left; width:317px; }
		.pull-right1 { float:left; }
		.pull-right1.select { width:auto; }
		.search-box { margin-top:10px; }

		
		.data-box {
			width: 471px;
			height: 30px;
			border-radius: 6px;
			border: 1px solid #e8e8e8;
			padding-bottom: 0;
			position: relative;
			float:left; 
			margin-top:2px;
		}
		
		.data-box input {
			color: #a7a7a7;
			width: 228px;
			border: none;
			text-align: center;
			line-height: 28px;
		}
		
		.search-btn { margin-left:20px; }
		th,td { text-align:center; }
		
		
		
		
		
		
		
		
		.modal-dialog { width:860px; }
.modal-body-title { border-bottom:1px solid #e5e5e5; padding-bottom:15px;  }
ul li { list-style:none; }
.main-title-box { overflow:hidden; }
.main-title { width:10px; height:20px; background:rgba(255, 153, 0, 1); display:block; float:left; }
.main-box { margin-top:20px; display:table; }
.main-txt { margin-left:10px; }
.main-list-item { float:left; width:650px; }
.main-list-item li { line-height:34px; display:table; margin-top:15px;  }
.main-list-item li span:nth-child(1){ display:block; float:left; font-weight:700; font-family: 'Arial Negreta', 'Arial'; width:100px;
 text-align:right; margin-right:20px;  }
.btn-primary { background:#5cb85c; border-color:#4cae4c; }

.conpanyname { float:left; }

.main-list-item.conpany { margin-bottom:20px; }
#addIndustry .btn-default { margin-left:20px; }

.modal-dialog { width:950px; }

.main-list-item .radio { float:left; } 
.main-list-item .radio  i { font-style:normal;}
.main-list-item .radio  input { margin-top:10px; }
.achivement-list  { display:table; width:210px }
.achivement-list>span { width:100%; display:table; margin-bottom:10px; }

.achivement-list ul li { border:1px solid #e5e5e5; width:98px; text-align:center; line-height:30px; }
.achivement-list ul li { border-bottom:none; }
.achivement-list ul li:last-child { border-bottom:1px solid #e5e5e5;}
.achivement-list ul li:first-child { background:#f6f6f6; }



#myModaltwo { background:rgba(0,0,0,0.8);  }
#myModaltwo .main-list-item { width:auto; float:none; margin:50px auto; display:table; }
#myModaltwo .main-list-item li span:nth-child(1) { width:auto;   }
#myModaltwo .main-box { margin-top:0px; }
#myModaltwo .main-list-item li:nth-child(1) { margin-top:0px;   }
@media (min-width: 768px){
	#myModaltwo  .modal-dialog {
		width: 600px;
		margin: 250px auto;
	}
}


		body {  padding:20px; }
		footer div.nav_bottom>div { box-sizing: border-box;}
		#home_index div.area ul.list i.close { background:  url(../images/close.png)no-repeat 50%; }
		.area-box { display:none; }
		.main-box { width:100%; }
		.main-box .main-title {   font-family: 'Arial Negreta', 'Arial';
			font-weight: 700;
			font-style: normal;
			font-size: 16px;
			border-bottom:1px solid #dddddd; 
			padding-bottom:10px;
		}
		
		.login { overflow:hidden; }
		
		.task-list { margin-left:70px; width:700px;  float:left; }
		
		.task-list>li {
			margin-top:20px;
		}
		.task-list li span:nth-child(1){
			float:left; 
			display:table;
			width:120px; 
			text-align:right;
		}
		
		.task-list li.item span:nth-child(2){
			margin-left:20px; 
		}
		
		.login .areaList { width:430px; }
		
		.input.js_input  label { display:none; }
		.login #home_index {  float:left;   }
		.login .areaList { padding:0; margin:0; }
		li.special { display:table; }
		.achivement-list ul { float:left; }
		.task-list textarea { width:280px; height:80px; resize:none;    background-color: #fff;  border: 1px solid #ccc; }
		.task-list li .test span { display:none; }
		
		.task-list li .test span:nth-child(1){ margin-left:20px; margin-right:20px; display:block; width:auto; cursor:pointer; color:#FF9933; }
		.test span:nth-child(1):hover { text-decoration:underline; }
	
		.task-list li .test span:nth-child(4){ margin-left:15px; }
		
		.upload { overflow:hidden; }
		
	
		
		.success-bottom { text-align:center; }
		
		.login ul, ol { margin:0; }
		
		body.login { font-family:none; }
		.task-list li div.hot span:nth-child(1) { width:auto; }
		
		body.login div.area div.search ul { margin-top:0; }
		
		body.login div.area ul.list { text-align:left; }
		body.login div.area ul.list li { text-align:center; }
		body.login .areaList { background:none; }
		.files-m { float:left; }
		body.login  form { margin:0; }
		
		.main-list-item #home_index li { margin-top:-1px; }
		.login div.area div.list3 ul.area li.js_key { margin-bottom:5px; }
		
		
		.login .area>div div:not(.list4) .search-citys-list li { margin-bottom:15px; }
		
		#s-citys1 { padding-bottom:30px; }
		
		.area-box ul.area { padding-bottom:30px; }
		.login .form-control { display:table-cell; width:auto; }
		
		
	 .btn-success.btn-lg { padding:6px 12px; }
	 .btn-lg, .btn-group-lg>.btn { font-size:14px; }
	 
	 
	 .text.city_name.ac_input { display:none; }
	 div.area div.search ul.citytop { float:left; }
	 .main-list-item #home_index .area .area-box >ul li { margin-top:0px;  line-height: 45px;}
	 div.area .area-box ul.list li:nth-child(1) { border-left:0px; }
	 div.area>div { top:32px; }
	 
	
	.btn-primary {
		background: #5cb85c;
		border-color: #4cae4c;
	}
	
	.bootstrap-table .fixed-table-toolbar {  overflow:-hidden; }
	.pull-left.search { display:none; height:auto;}

	.bootstrap-table { margin-top:-30px; }
	
	#unitprice-error { margin-left:30px; }
	label.error { color:red; font-weight:normal; margin-left:20px; }
	
	.unitpriceyuan { position:absolute; left:175px; top:0; }
	</style>
</head>
<body class="login">
    <div class="container">
		<div>
			<span class="requiredname"></span>
		</div>
		
		
        <table id="table">
            
        </table>
   
	
	
	<div id="forlogin">
		 <div>
			<ul class="industry">
				<li class="first" >行业名称:</li>
				<li class="last"><input id="username" placeholder="请输入行业名称"/></li>
			</ul>
			<ul class="high">
				<li  class="first" >分类级别:</li>
				<li class="high-n last">一级分类</li>
			</ul>
			<ul>
				<li  class="first" >状态:</li>
				<li class="last">
					<div class="running"><input type="radio" /><span>启用</span></div>
					<div class="outOff"><input type="radio" /><span>停用</span></div>
				</li>
			</ul>
			<ul class="descening">
				<li  class="first" >排序值</li>
				<li class="last"><input placeholder="请输入排序值，值越大越靠前"/></li>
			</ul>
		 </div>
	</div>
	
	
	 <div id="addIndustry">
		<button   class="btn btn-primary  btn-success btn-lg" >创建任务</button>
		<button  class="btn btn-default returnpage">返回</button>
	 </div>
	</div>
	
	
	
	
	<!--弹出成-->
	<form id="commentForm" method="get" action="">
		<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					创建任务
				</h4>
			</div>
			<div class="modal-body">
				<!--<div class="modal-body-title"><span class="main-title"></span><span class="main-txt">任务概况：</span></div>-->
				<div class="main-box order">
					
					<ul class="main-list-item task-list otherdata">
						<li>
							<span>任务名：</span>
							<span class="tasknames"> </span>
						</li>		
						
						<li class="special">
							<span>任务目标区域：</span>
							<div id="home_index"></div>
						</li>
						
						
						
						
						<li>
							<span>任务单价：</span>
							<div style="position:relative;" class="pull-right1 select">
								<input class="form-control unitprice" name="unitprice" type="number" />
								<span class="unitpriceyuan" style="margin-left:10px" >元</span>
							</div>
						</li>
						
						
						<li>
							<span>备注：</span>
							<div class="pull-right1 select">
								<textarea class="comment"></textarea>
							</div>
							
						</li>
					</ul>
					
					
					<ul class="main-list-item task-list datahandle">
						<li>
							<span>任务名：</span>
							<span class="tasknames"><input  name="tasknames" class="form-control" type="text" /></span>
						</li>		
					
						
						
						
						<li>
							<span>任务单价：</span>
							<div class="pull-right1 select">
								<input name="unitprice" class="form-control unitprice" type="number" />
								<span style="margin-left:10px" >元</span>
							</div>
							<div class="datacleanunitprice" style="float:left; margin-left:20px;"></div>
						</li>
						
						<li>
							<span>需求描述：</span>
							
							<span class="demanddesc"></span>
							
						</li>
					</ul>
					
					
					
					
					<ul class="main-list-item task-list">
						<form></form>
						<li class="upload">
							<span>销售线索模板：</span>
							<span class="files-m">
						
							<form id="salepad" action=""  enctype="" >
								<div>
									<span style="display:none;">文件路径</span>
									<input style="display:none;" class="idkey" type="text" name="key" value="" />
									<span style="display:none;">OSSAccessKeyId</span>
									<input style="display:none;" class="idOSSAccessKeyId" type="text" name="OSSAccessKeyId" value="" />
									<span style="display:none;">policy</span>
									<input style="display:none;" class="idpolicy" type="text" name="policy" value="" />
									
									<input style="display:none;" class="status" type="text" name="success_action_status" value="200" />
									

									<span style="display:none;">Signature</span>
									<input style="display:none;" class="idSignature" type="text" name="Signature" value="" />
									
									<input  style="display:none;" name="file" type="file"  class="file" />
								</div>
							</form>
							<div class="salepad test"><span>上传文件</span><span class="js_mark">上传成功</span><span class="js_mark">上传失败</span><span class="js_mark saleleads"></span></div>
							</span>
						</li>
						
						
						
						<li class="upload">
					<span>话术文件：</span>
					<span class="files-m">
					
						<form id="wordFile" action=""  enctype="" >
						<div>
							<span style="display:none;">文件路径</span>
							<input style="display:none;" class="idkey" type="text" name="key" value="" />
							<span style="display:none;">OSSAccessKeyId</span>
							<input style="display:none;" class="idOSSAccessKeyId" type="text" name="OSSAccessKeyId" value="" />
							<span style="display:none;">policy</span>
							<input style="display:none;" class="idpolicy" type="text" name="policy" value="" />
							
							<input style="display:none;" class="status" type="text" name="success_action_status" value="200" />
							

							<span style="display:none;">Signature</span>
							<input style="display:none;" class="idSignature" type="text" name="Signature" value="" />
							
							<input style="display:none;"   name="file" type="file"   class="file" />
						</div>
							
						</form>
						<div class="wordFile test"><span>上传文件</span><span class="js_mark">上传成功</span><span class="js_mark">上传失败</span><span class="js_mark speechcraft"></span></div>
					</span>
				</li>
						
						
						
					<li class="upload">
						<span>质检标准：</span>
						<span class="files-m">
						
							<form id="quality" action=""  enctype="" >
							<div>
								<span style="display:none;">文件路径</span>
								<input style="display:none;" class="idkey" type="text" name="key" value="" />
								<span style="display:none;">OSSAccessKeyId</span>
								<input style="display:none;" class="idOSSAccessKeyId" type="text" name="OSSAccessKeyId" value="" />
								<span style="display:none;">policy</span>
								<input style="display:none;" class="idpolicy" type="text" name="policy" value="" />
								
								<input style="display:none;" class="status" type="text" name="success_action_status" value="200" />
								

								<span style="display:none;">Signature</span>
								<input style="display:none;" class="idSignature" type="text" name="Signature" value="" />
								
								<input  style="display:none;"  name="file"  type="file"   class="file" />
							</div>
							</form>
							<div class="quality test"><span>上传文件</span><span class="js_mark">上传成功</span><span class="js_mark">上传失败</span><span class="js_mark qualitystandard"></span></div>
						</span>
					</li>
						
						
						
						
						
						
						
						
						
					</ul>
					<div class="achivement-list">
					</div>
					
					<!--
					<ul class="main-list-item">
						<li>
							<span>需求名：</span>
							<span>e-darrn-100</span>
						</li>
						<li>
							<span>需求量</span>
							<span>1000</span>
						</li>
					</ul>
					-->
				</div>
				
				
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-primary determine"   >
					确认创建
				</button>
				<button type="button"  data-dismiss="modal"  class="btn">
					取消
		</button>
		<input style="display:none;" id="form-sub" type="submit" />
		</div><!-- /.modal-content -->
		
		
	</div><!-- /.modal-dialog -->
	
	</div>
</div>
</form>













	<!--弹出层-第二层-->
		<div class="modal fade" id="myModaltwo" tabindex="10" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					确认创建
				</h4>
			</div>
			<div class="modal-body">
				
				<div class="main-box">
					
					<ul class="main-list-item">
						<li>
							<span>确认创建任务嘛？</span>
						</li>
						
					</ul>

			
				</div>
		
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-primary last btn-default" >
					确认
				</button>
				<button type="button"  data-dismiss="modal"  class="btn">
					取消
		</button>
		</div><!-- /.modal-content -->
		
		
	</div><!-- /.modal-dialog -->
	
	</div>
</div>


<div class="modal fade" id="loading" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" data-backdrop='static'>
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title" id="myModalLabel">提示</h4>
      </div>
      <div class="modal-body">
        请稍候。。。
      </div>
    </div>
  </div>
</div>

</body>
		
<script>

/*获取具体数据*/

	var taskrqueiredata = JSON.parse($.sessionStorage('taskrqueiredata'));
	
	//需求名 
	$('.requiredname').html('需求名：'+taskrqueiredata.demandname);
	
	var  servicetype = taskrqueiredata.servicetype;
	//不是数据类型
	if(servicetype!=2){
		//不是数据加工调出这个list
		createachivementlist({ele:'.achivement-list',demandid:taskrqueiredata.id,publics:'price'});
	}
	
	var brandname =   taskrqueiredata.brandname;
	var onoffline2 =  taskrqueiredata.onoffline?'线上':'线下';
	var district = "";
	/*三级行业*/
	var industryxifen = taskrqueiredata.industryxifen;
	/*归属年月*/
	var vestingtime =  taskrqueiredata.vestingtime;
	
	if(vestingtime){
		var tmparr  =  vestingtime.split('-');
		vestingtime = tmparr[0]+tmparr[1];
	}

	
	/*是否标准 */
	var standard =  taskrqueiredata.standard;
	
	var taskname="";

//禁止输入
$(document).on('focus','.select.area.js_area',function (ev){
	var target = ev.currentTarget;
	$(target).attr('readonly','readonly');
	//debugger;
});


$(document).on('click','.js_key',function (){
	district = $('.select.area.js_area').val();
	//debugger; 1标准发包  0非标准发包(非标准不要线上线下)
	if(standard){
		//标准
		if(brandname){
			taskname = brandname +'-'+ onoffline2  +'-'+ district  +'-'+ industryxifen  +'-'+ vestingtime;
		}else{
			taskname = onoffline2  +'-'+ district  +'-'+ industryxifen  +'-'+ vestingtime;
		}
		
	}else{
	
		if(brandname){
			taskname = brandname +'-'+  district  +'-'+ taskrqueiredata.industry  +'-'+ vestingtime;
		}else{
			taskname = district  +'-'+ taskrqueiredata.industry  +'-'+ vestingtime;
		}
		
		
	}
	
	console.log(onoffline2 );
	$('.tasknames').html(taskname);
});




$('.btn-success').click(function (){
	

	//console.log(taskrqueiredata);
	/*任务名，规则为：
	
	生成规则为：品牌名-线上或线下+任务目标区域-三级行业分类+归属年月；刚进来选择目标区域之前，没有目标区域，则任务名里面的目标区域暂不显示，等选完目标区域后再实时更新；
	*/

	//debugger;
	if(standard){
		if(brandname){
			taskname = brandname +'-'+ onoffline2  +'-'+ district  +'-'+ industryxifen  +'-'+ vestingtime;
		}else{
			taskname = onoffline2  +'-'+ district  +'-'+ industryxifen  +'-'+ vestingtime;
		}
	}else{
		if(brandname){
			taskname = brandname +'-'+  district  +'-'+ taskrqueiredata.industry  +'-'+ vestingtime;
		}else{
			taskname = district  +'-'+ taskrqueiredata.industry  +'-'+ vestingtime;
		}
	}
	
	console.log(taskrqueiredata);
	if((standard == 0 || standard == 1) && servicetype!=2){
		//debugger;
		//datahandle otherdata
		/*标准*/
		$('.otherdata').show();
		
		$('.datahandle').hide();
		//brandname
		$('.tasknames').html(taskname);
	}
	
	//if(servicetype=="2"){
		/*非标准*/
		//$('.datahandle').show();
		//$('.datahandle').hide();
	//}
	
	if(servicetype=="2"){
		$('.otherdata').hide();
		$('.datahandle').show();
		/*数据加工*/
		//debugger;
		var datataskname  = brandname +'-'+  taskrqueiredata.demandname  +'-'+ vestingtime;
		$('.tasknames input').val(datataskname);
		//debugger;
		$('.demanddesc').html(taskrqueiredata.demanddesc);
		
		$('.datacleanunitprice').html('合同单价：'+taskrqueiredata.datacleanunitprice.toFixed(2)+'元');
		
		
	}
	/*清空相关字段*/
	$('.select.area.js_area').val('');
	$('.unitprice').val('');
	$('.comment').val('');
	
	$('.salepad.test').html('<span>上传文件</span><span class="js_mark">上传成功</span><span class="js_mark">上传失败</span><span class="js_mark saleleads"></span>');
	$('.wordFile.test').html('<span>上传文件</span><span class="js_mark">上传成功</span><span class="js_mark">上传失败</span><span class="js_mark speechcraft"></span>');
	$('.quality.test').html('<span>上传文件</span><span class="js_mark">上传成功</span><span class="js_mark">上传失败</span><span class="js_mark qualitystandard"></span>');

	
	
	$('#myModal').modal('show');
});




var url =  domain137 + '/csusers/'+roleid+'/demands/'+taskrqueiredata.id+'/tasks';



var $table = $('#table');
	//debugger;
	//文档地址http://bootstrap-table.wenzhixin.net.cn/zh-cn/documentation/



$('#table').bootstrapTable({
	 url:url,
	 pagination: true, //分页
	 contentType:'application/json',
    // search:true,
	 checkbox:false,
	 showColumns:true,
	 queryParams:function (params){
			 /*自定义参数,如果有参数在这里定义*/
			  var data = {all:ifAll};
			  
			  data.limit = params.limit;
			  data.offset = params.offset;
			 //data.pageSize = 5;
			 //debugger;
		 data.size = 100000000;
		
	    return  data;
	 },
	 //sidePagination: "server",
	 sidePagination: "client",
	 pageSize:5,
	 responseHandler:function(res){

	 /*sidePagination server pageSize需要设置再请求参数 queryParams server 用rows*/
	 /*sidePagination client pageSize需要设置再请求参数 直接设置 client 用data */
	 
		var newJson = {};
		newJson.total = '800';
		//newJson.rows = res.list;
		newJson.data = res.data;
		//debugger;
		return newJson;
     },
	 formatNoMatches:function(){
         return '没有搜索结果'
     },
     formatLoadingMessage:function(){
          return '正在努力加载中...';
     },
	 columns: [{  
          field: 'uniquename',  
          title: '任务名'  
        }, {  
          field: 'targetarea',  
          title: '目标区域'  
        }, {  
          field: 'unitprice',  
          title: '任务单价',
        }, {  
          field: 'createtime',  
          title: '创建时间'  
        }]  
		
});

$('#myModal').on('click','.determine',function (){

	$('#form-sub').submit();
	 
	if($('label.error:visible').get(0)){
		return;
	}
	$('#myModaltwo').modal('show');
	//data-toggle="modal" data-target="#myModaltwo"
});



	/*更新数据详情*/
$('#myModaltwo').on('click','.btn-primary.last',function (){
	/*确认指派订单*/
		//POST 开发完成 /pasf/csusers/{csuserid}/demands/{demandid}/tasks
		var addData = {};
		var url = domain137 + '/csusers/'+roleid+'/demands/'+taskrqueiredata.id+'/tasks';
		
		
		//统一收集数据
		
		
		$('#myModaltwo').modal('hide');
		$('#myModal').modal('hide');
		$('#loading').modal('show');
		//$('#myModal').modal('hide');
		var  servicetype = taskrqueiredata.servicetype;
		if(servicetype==2){
			/*数据加工少两个字段*/
			addData.taskname = $('.datahandle .tasknames input').val();
			addData.unitprice = $('.datahandle .unitprice').val();
			addData.targetarea = "";
			addData.comment =  taskrqueiredata.demanddesc;
		}else{
			addData.taskname = $('.otherdata .tasknames').html();
			addData.targetarea = $('.select.area.js_area').val();
			addData.unitprice = $('.otherdata .unitprice').val();
			addData.comment =  $('.comment').val();
		}
		
		addData.demandid = taskrqueiredata.id;
		addData.servicetype = taskrqueiredata.servicetype;
		addData.saleleads =  $('.saleleads').attr('saleleads');
		addData.speechcraft =  $('.speechcraft').attr('speechcraft');
		addData.qualitystandard =  $('.qualitystandard').attr('qualitystandard');
		
		
		/*
		
			 {
			"demandid": "需求ID",
			"servicetype": "服务类型",
			"taskname": "任务名称",
			"targetarea": "任务目标区域",
			"unitprice": "任务单价",
			"comment": "任务备注",
			"saleleads": "销售线索模板文件URL",
			"speechcraft": "话术文件URL",
			"qualitystandard": "质检标准文件URL"
		  }
		*/
		//tasknames
		//debugger;
		
		
		$.when($.ajax({
			url:url,
			type:'POST',
			contentType:'application/json',
			data:JSON.stringify(addData),
		})).then(function (data){
			if(data.msg == "success"){
				$('#loading').modal('hide');
				$('#table').bootstrapTable('refresh');
			}
		}).fail(function (data){
		
		});
	});

	
var newDate = new Date();
var time = newDate.toJSON();
 $(".start_date")
 .datetimepicker({
		language:  'zh-CN',
		 weekStart: 1,
		 todayBtn:  1,
		 autoclose: 1,
		 todayHighlight: 1,
		 startView: 2,
		 minView: 2,
		 forceParse: 0,
		 format: 'yyyy-mm-dd',
		 startDate:new Date(time),
}).on("click",function(ev){
		$(".start_date").datetimepicker("setEndDate", $(".end_date").val());
}).on("change",function(ev){
	$(".startDate").html($(".start_date").val());
	$(".start_date").blur();
}).on("blur",function(ev){
	if(isNull($(".start_date").val())){
		$(this).parent().find("p.error").eq(0).show();
	}else{
		$(this).parent().find("p.error").eq(0).hide();
	}
});
					
$(".end_date")
.datetimepicker({
			language:  'zh-CN',
				 weekStart: 1,
				 todayBtn:  1,
				 autoclose: 1,
				 todayHighlight: 1,
				 startView: 2,
				 minView: 2,
				 forceParse: 0,
				 format: 'yyyy-mm-dd',
}).on("click", function (ev) {
		$(".end_date").datetimepicker("setStartDate", $(".start_date").val());
}).on("change",function(ev){
$(".endDate").html($(".end_date").val());
$(".end_date").blur();
}).on("blur",function(ev){
	if(isNull($(".end_date").val())){
		$(this).parent().find("p.error").eq(1).show();
	}else{
		$(this).parent().find("p.error").eq(1).hide();
	}
});



</script>
<script src="../../static/darrenhtml/js/testmobx.bundle.js" ></script>
<script src="../js/testmobx.bundle.js" ></script>
<script>
	//list = {ele:'.achivement-list'}
	

	
	
	
	//上传文件
	
	$('.salepad').click(function (){
		//debugger;
		$('.salepad .js_mark').hide();

		return $('#salepad .file').click();
	});
	
	$('#salepad .file').click(function (){
		var signature = JSON.parse(getSignature({fileName:'credentials'}));
		
		$('#salepad .file')[0].onchange = function (){
			var file = this.files[0];
			//debugger;
		
			/*成功以后返回对象直接使用*/
			var then = setupload({
				formId:'#salepad',
				key:'.idkey',
				OSSAccessKeyId:'.idOSSAccessKeyId',
				policy:'.idpolicy',
				Signature:'.idSignature'
			},signature);
			
			//debugger;
			var filePath = signature.dir + file.name;
			
			then.then(function (data){
				//上传成功
				$('.salepad span').eq(1).show();
				$('.saleleads').show().attr('saleleads',filePath).html('文件名为：'+file.name);
				//debugger;
				
			}).fail(function (data){
				$('.salepad span').eq(2).show();
				//debugger;
				//上传失败
			});
			
		};
	});
	
	$('.wordFile').click(function (){
		$('.wordFile .js_mark').hide();
	//debugger;
		return $('#wordFile .file').click();
	});
	$('#wordFile .file').click(function (){
		var signature = JSON.parse(getSignature({fileName:'credentials'}));
		
		$('#wordFile .file')[0].onchange=function (){
			var file = this.files[0];
			/*成功以后返回对象直接使用*/
			var then = setupload({
				formId:'#wordFile',
				key:'.idkey',
				OSSAccessKeyId:'.idOSSAccessKeyId',
				policy:'.idpolicy',
				Signature:'.idSignature'
			},signature);
			
			var filePath = signature.dir + file.name;
			then.then(function (data){
				
				$('.wordFile span').eq(1).show();
				$('.speechcraft').attr('speechcraft',filePath).show().html('文件名为：'+file.name);
				//debugger;
				//上传成功
			}).fail(function (data){
				//debugger;
				//上传失败
				$('.wordFile span').eq(2).show();
			});
			
		};
	});
	
	
	
	$('.quality').click(function (){
		$('.quality .js_mark').hide();
	//debugger;
		return $('#quality .file').click();
	});
	
	
	$('#quality .file').click(function (){
	
		var signature = JSON.parse(getSignature({fileName:'credentials'}));
		
		$('#quality .file')[0].onchange = function (){
			var file = this.files[0];
			/*成功以后返回对象直接使用*/
			var then = setupload({
				formId:'#quality',
				key:'.idkey',
				OSSAccessKeyId:'.idOSSAccessKeyId',
				policy:'.idpolicy',
				Signature:'.idSignature'
			},signature);
			
			var filePath = signature.dir + file.name;
			then.then(function (data){
				//debugger;
				//上传成功
				$('.quality span').eq(1).show();
				$('.qualitystandard').show().attr('qualitystandard',filePath).html('文件名为：'+file.name);
			}).fail(function (data){
				$('.quality span').eq(2).show();
				//debugger;
				//上传失败
			});
			
		};
	});
	
	
	$('.returnpage').click(function (){
		history.go(-1);
	});
	
	
	
	
	
	
	

				$('.select.area.js_area').attr('name','js_area');
				console.log($('.select.area.js_area'));
				$("#commentForm").validate({
					 "rules": {
					  "js_area": {
						"required": true,
						//"minlength": 2,
						//isText:true
					  },
					  "unitprice":{
						  "required": true,
						 // "minlength": 2,
					  },
					   "tasknames":{
						  "required": true,
						 // "minlength": 2,
					  },
					  
					
					  
					},
					"messages": {
						"js_area": {
							"required":'请选择城市！',
							//"minlength": '请选择城市！',
						},
						"unitprice":{
						  "required":'请输入单价！',
						   
					    },
						"tasknames":{
						  "required": '请输入任务名称！',
						 // "minlength": 2,
					  },
						
						//
					}
				});
	
				
		
			$("#commentForm :input").blur(function (){ 
				$(this).valid();
			});
	
	
</script>

</html>