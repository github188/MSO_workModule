<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Bootstrap Table Examples</title>


	<link rel="stylesheet" href="../css/bootstrap.min.css" />
	<link rel="stylesheet" href="../css/bootstrap-table.css" />
	<link rel="stylesheet" href="../css/bootstrap-datetimepicker.css" />
	<link rel="stylesheet" href="https://back.mshuoke.com/static/ace/css/datepicker.css">
	<script src="../js/jquery.js" type="text/javascript"></script>
    <script src="../js/bootstrap.min.js"></script>
	<script src="../js/bootstrap-table.min.js" type="text/javascript"></script>
	<script src="../js/bootstrap-datetimepicker.min.js" type="text/javascript"></script>
	<!-- <script src="https://back.mshuoke.com/static/darrenhtml/js/bootstrap-datetimepicker.min.js" type="text/javascript"></script> -->
	<script src="../js/url.js" type="text/javascript"></script>
	<link rel="stylesheet" href="https://back.mshuoke.com/static/ace/css/font-awesome.css">
	<link rel="stylesheet" href="https://back.mshuoke.com/css/style_1.css">
	<!-- <script  type="text/javascript" src="../js/layer/laydate/laydate.js"></script> -->
	<!-- <link rel="stylesheet" href="../js/layer/laydate/need/laydate.css"> -->
	<script src="../js/myself-function/main.js" type="text/javascript"></script>
	
	
	<style>


	#main-container{
		width: 1000px;
		height: 517px;
	}

		#forlogin { display:none; background:#ffffff;  overflow:hidden; height:100%; }
		*{ padding:0; margin:0; }
		ul li { list-style-type:none; }
		#forlogin ul { width:100%; overflow:hidden; margin-top:20px;  }
		#forlogin ul li { float:left; width:50%; }
		
		#forlogin ul li.first {width:60px; text-align:right; }
		#forlogin ul.industry{ margin-top:30px; }
		#forlogin ul.industry li {  }
		#forlogin ul.industry li input { float:left;  }
		#forlogin ul.high li.high-n   { text-align:left;  }
		
		#forlogin ul li.last  { padding-left:20px;  }
		#forlogin ul li .running { float:left;  width:70px; height:20px; }
		#forlogin ul li .outOff { float:left; width:70px; height:20px; }
		#forlogin ul li .outOff  span { float:left; margin-top:2px; margin-left:5px;  display:inline-table; }
		#forlogin ul li .running  span { float:left; margin-top:2px;    margin-left:5px;   display:inline-table; }
		#forlogin ul li .outOff input { float:left; }
		#forlogin ul li .running input { float:left; }
		#forlogin ul.descening li input { float:left; }
		#addIndustry  { margin-top:20px; }
		#toolbar { width:120px; } 
		.fixed-table-toolbar { width:120px; }
		.industrySetting { width:100%; overflow:hidden; margin-top:20px; margin-bottom:0; }
		.industrySetting li { float:left; }
		.search-box { overflow:hidden; padding-bottom:3px; }
		.search-box  .fixed-table-toolbar { float:left; }
		.search-box  #toolbar {margin-left:20px; float:left; margin-top:10px; margin-bottom:10px; }
		.bootstrap-table { margin-top:15px; }
		
		
		@media (min-width: 100px) {
			.container {
				width: auto;
			}
		}
		.fixed-table-toolbar { width:100%; }
		
		.pull-right1.search { margin-top:0; float:left; width:200px; }
		.pull-right1 { float:left; }
		.pull-right1.select { width:127px; }
		.search-box { margin-top:10px; }
		.bootstrap-table  .fixed-table-toolbar { height:60px; }
		
		.data-box {
			width: 471px;
			height: 30px;
			border-radius: 6px;
			border: 1px solid #e8e8e8;
			padding-bottom: 0;
			position: relative;
			float:left; 
			margin-top:2px;
		}
		
		.data-box input {
			color: #a7a7a7;
			width: 228px;
			border: none;
			text-align: center;
			line-height: 28px;
		}
		
		.search-btn { margin-left:20px; }
		th,td { text-align:center; }
			.modal-dialog { width:860px; }
.modal-body-title { border-bottom:1px solid #e5e5e5; padding-bottom:15px;  }
ul li { list-style:none; }
.main-title-box { overflow:hidden; }
.main-title { width:10px; height:20px; background:rgba(255, 153, 0, 1); display:block; float:left; }
.main-box { margin-top:20px; overflow:hidden;  }
.main-txt { margin-left:10px; }
.main-list-item { float:left; width:400px; }
.main-list-item li { line-height:38px; }
.main-list-item li span:nth-child(1){ font-weight:700; font-family: 'Arial Negreta', 'Arial';}
.btn-primary { background:#5cb85c; border-color:#4cae4c; }

.conpanyname { float:left; }

.main-list-item.conpany { margin-bottom:20px; }



.btn-success.btn-lg { padding:6px 12px; }
.btn-lg, .btn-group-lg>.btn { font-size:14px; }
.pull-right1.select.search-btn { margin-left:15px; }
.bootstrap-table .fixed-table-toolbar {  overflow:-hidden; }
.pull-left.search { display:none; height:auto;}
.bootstrap-table { margin-top:-30px; }
	</style>
</head>
<body>
    <div class="container">
		<div class="search-box">
			<div class="fixed-table-toolbar">
				<div class="pull-right1 search">
					<input class="form-control" type="text" placeholder="Search">
				</div>
				<!--
				<div class="pull-right1 select">
					<select class="form-control">
						<option value="5">选择AE负责人</option>
						<option value="10">10</option>
						<option value="50">50</option>
					</select>
				</div>
				
				<div class="pull-right1 select">
					<select class="form-control">
						<option value="">all</option>
						<option value="">open</option>
						<option value="all">close</option>
					</select>
				</div>
				<div class="pull-right1 select">
					<select class="form-control">
						<option value="">all</option>
						<option value="">open</option>
						<option value="all">close</option>
					</select>
				</div>
				
				<div class="data-box">
						<input autoComplete="off" placeholder="开始日期" type="text" class="form_date start_date" readOnly /><i class="date_icon"></i><span>~</span>
						<input autoComplete="off" placeholder="结束日期" type="text" class="form_date end_date" readOnly /><i class="date_icon"></i>
						<p class="error time">请填写开始日期</p><p class="error time">请填写结束日期</p>
				</div>
				-->
				<div class="pull-right1 select search-btn">
					<button type="button" class="btn btn-success search2">搜索</button>
				</div>
			</div>
		</div>
        <table id="table">
            
        </table>
   
	<div style="margin-top:20px">
		<a class="btn btn-mini btn-success" onclick="Add('add');">新增</a>
		<a class="btn btn-mini btn-success" onclick="javascript:history.go(-1)">后退</a>
	</div>
	
<!-- 弹出层start -->
<div class="cover" style="position: fixed;top:0;left:0;height:100%;width:100%;background-color: #333;opacity: 0.4;z-index:100 ;display: none;"></div>
<div id="_Container_0" style="position: fixed; top:50%;left:50%;margin:-286px 0 0 -500px; width: 1000px; height: 572px;z-index:110; display: none;">
<div style="position: absolute; height: 100%; width: 100%; display: block; opacity: 0.5;" id="_Covering_0">&nbsp;</div>
<div class="main-container" id="main-container" style=" background-color:#fff; >
	
		<div class="main-content">
			<div class="main-content-inner">
				<div class="page-content">
					<div class="row">
						<div class="col-xs-12">
					<form action="finishReport/saveCeQa.do" name="reviewForm" id="reviewForm" method="post">
						<!-- 保存附件_url-->
						<input type="hidden" name="census_recording_url" id="census_recording_url" value="">
						<input type="hidden" name="servicetype" id="servicetype" value="销售线索挖掘">
						<!-- 设置模板_url所需要的数据-->
					<!--	<input type="hidden" class="myupload" data-id="6ea5f3a9d3bb4cbc8165f71e8c71402e" data-type="census" data-u="https://back.mshuoke.com:443/"/>  -->
						<!--end -->
						<input type="hidden" name="stid" id="stid" value="6ea5f3a9d3bb4cbc8165f71e8c71402e">
						<input type="hidden" name="demandid" id="demandid" value="201707220207165271">
						<input type="hidden" name="jfuid" id="jfuid" value="20170510025637841">
						<input type="hidden" name="ordername" id="ordername" value="fdj-线上-高考辅导">
						<input type="hidden" name="dreleasenum" id="dreleasenum" value="200">
						<input type="hidden" name="isdisable" id="isdisable" value="">
						<input type="hidden" name="csstatus" id="csstatus" value="">
						<input type="hidden" name="pid" id="pid" value="20170722020716518">
						<!-- 之前保存的时间 -->
						<input type="hidden" id="censusdayrangeBefore" value="">
						<!--是否为编辑 -->
						<input type="hidden" id="flag" value="">
						<!--设置隐藏域保存统计时间的jsonArray -->
						<input type="hidden" id="jsonArray" value="[{&quot;censusday&quot;:&quot;2017-07-27&quot;,&quot;stid&quot;:&quot;d9ae748f99814529bc16c49add22df10&quot;}]">
						<!--<input type="hidden" name="isfollow" id="isfollow" value=""/>-->
						<div id="zhongxin" style="padding:13px 0 20px 0; background-color:#ffffff;border:6px solid #438eb9;border-top-width:30px">
						<div style="position:absolute;top:0;padding: 9px 0 0 4px; float: left; font-weight: bold; color:#fff;"><img  style="float: left;margin-top: 4px;" align="absmiddle" src="https://back.mshuoke.com/plugins/attention/zDialog/skins/blue/icon_dialog.gif"><span id="_Title_0" style="float: left;font-size: 12px">新增</span></div>
						<div class="cancel" class="closeBtn" style="margin: 4px 0px 0px;
												    position: relative;
												    top: -38px;
												    cursor: pointer;
												    float: right;
												    height: 17px;
												    width: 28px;
												    background:url('https://back.mshuoke.com/plugins/attention/zDialog/skins/blue/dialog_closebtn.gif');">
							
						</div>
						<div class="content_right">
	    			<div class="new_demand order_details">
	    				<div class="title">IT录音文件汇总</div>
	    	<!--			<div class="title_order">需求名称：fdj-线上-高考辅导</div>
	    				<div class="details_order">
	    					<h3>每单 ¥ ，共需要单，总价为<span> ¥ </span></h3>
							<div class="title_order">订单名称：fdj-线上-高考辅导</div>
	    				<div class="details_order">
	    					<h3>每单 ¥ ，申请单，总价为<span id="sumo"></span></h3>  -->
	    			

	    		<!--			<p>项目开始日期：2016-03-01，结束日期：2016-04-01，<span class="color_orange">剩余完成时间为24天：</span></p>
	    					<div class="rate_box1">
	    						<style>
	    							@keyframes mymove2
									{
										from {width:0;}
										to {width:20%;}
									}	
									@-webkit-keyframes mymove2 /* Safari and Chrome */
									{
										from {top:0px;}
										to {top:20%;}
									}	
	    						</style>
	    						<div class="rate_bar1 white" style="width: 20%;"><p>剩余24天</p></div>
	    					</div>
	    					<p>目前已完成400单，消耗金额为16000元，占比40%：</p>
	    					<div class="rate_box">
	    						<style>
	    							@keyframes mymove1
									{ 
										from {width:0;}
										to {width:40%;}
									}	
									@-webkit-keyframes mymove1 /* Safari and Chrome */
									{
										from {top:0px;}
										to {top:40%;}
									}
	    						</style>
	    						<div class="rate_bar orange" style="width: 40%;"><p>40%</p></div>
	    					</div>-->
	    				</div> 
	    				<div class="title_order">基本信息 </div>
	    				<div class="info_order">
	    					<ul>
								<li class="ID"><b>ID：</b><span></span></li>
								
								<li><b>需求名：</b><span>fdj-线上-高考辅导</span></li>
								<li><b>需求量：</b><span>200</span></li>
	    						
								
								<li><b>统计时间：</b><span id="json_time">
								<input class="span10 date-picker" type="text" name="censusday" id="start_date" value="" maxlength="32" placeholder="" title="统计时间" data-date-format="yyyy-mm-dd">~
								<input class="span10 date-picker" type="text" name="censusday" id="end_date" value="" maxlength="32" placeholder="" title="统计时间" data-date-format="yyyy-mm-dd">
								<!-- <input style="width:200px" class="form-control" id="end_date" name="end_date" value="" type="text" onclick="laydate({istime: false, format: 'YYYY-MM-DD'})"> -->
								<font  id="times" size="2" face="arial" color="red" key="0" style="display: none">请选择统计时间</font>
								
								<!-- <input type="checkbox" name="censusdayrange" value="2017-07-27">2017-07-27<input type="checkbox" id="allcheck" onclick="checkAll()">全选</span></li>  -->
						<!--		<li><b>发布时间：</b><span><input type="text" name="releasetime"  value="" id="datetimepicker" data-date-format="yyyy-mm-dd hh:ii:ss"  maxlength="32" placeholder="" title="发布时间"></span></li>  -->
								
						<!--		<li><b>成单报告汇总：</b><span>
								
								<a href="javascript:goMyUpload01();" id="upload01"  class="upload">上传</a>&nbsp
								<font id="ifupload01"  size="2" face="arial" color="red"></font>
								</span></li> -->
								<li><b>录音文件汇总：</b><span>
								<a id="down" href="">下载</a>
								<a id="upload02" class="upload" style="cursor: pointer">上传</a>&nbsp;
								<font id="ifupload02" size="2" face="arial" color="red" key="0"></font>
								</span></li> 
									
	    						
	    					</ul>
	    				</div>				
						</div>						
	    				<div class="backs" style="text-align: center;">
	    					<button class="btn_orange" type="button" onclick="save();">保存</button>
							<div class="cancel" style="cursor: pointer; display: inline-block;width: 98px;height:39px;text-align: center;line-height: 39px;color: #ffffff;background: #008cee; font-size:16px;">取消</button>
					<!--		<button class="btn_orange"  type="button"   onclick="test1();">测试</button>  -->
	    				</div>
	    			</div>
									</form></div>
									
								
						</div>
						<!-- /.col -->
					</div>
					<!-- /.row -->
				</div>
				<!-- /.page-content -->
			</div>
		</div>
<!-- 弹出层close -->

</div>

	<div id="forlogin">
		 <div>
			<ul class="industry">
				<li class="first" >行业名称:</li>
				<li class="last"><input id="username" placeholder="请输入行业名称"/></li>
			</ul>
			<ul class="high">
				<li  class="first" >分类级别:</li>
				<li class="high-n last">一级分类</li>
			</ul>
			<ul>
				<li  class="first" >状态:</li>
				<li class="last">
					<div class="running"><input type="radio" /><span>启用</span></div>
					<div class="outOff"><input type="radio" /><span>停用</span></div>
				</li>
			</ul>
			<ul class="descening">
				<li  class="first" >排序值</li>
				<li class="last"><input placeholder="请输入排序值，值越大越靠前"/></li>
			</ul>
		 </div>
	</div>
	</div>
	
	
	
	
	<!--弹出成-->
	<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×
				</button>
				<h4 class="modal-title" id="myModalLabel">
					分配专员
				</h4>
			</div>
			<div class="modal-body">
				<div class="modal-body-title">分配专员</div>
				<div class="main-box">
					
					<ul class="main-list-item">
						<li>
							<span>发包方公司名：</span>
							<span>e-darrn-100</span>
						</li>
						<li>
							<span>品牌名称：</span>
							<span>1000</span>
						</li>
					</ul>
					
					
					
					<!--
					<ul class="main-list-item">
						<li>
							<span>需求名：</span>
							<span>e-darrn-100</span>
						</li>
						<li>
							<span>需求量</span>
							<span>1000</span>
						</li>
					</ul>
					-->
				</div>
				
				<div class="modal-body-title"></div>
				<div class="main-box">
					<div class="main-title-box"><span class="main-title"></span><span class="main-txt">操作</span><div>
					<ul class="main-list-item conpany">
						<li>
							<span class="conpanyname">发包方公司名：</span>
							
							<div class="pull-right1 select">
									<select class="form-control">
										<option value="">all</option>
										<option value="">open</option>
										<option value="all">close</option>
									</select>
							</div>
						</li>
					</ul>
					
					
					
					<!--
					<ul class="main-list-item">
						<li>
							<span>需求名：</span>
							<span>e-darrn-100</span>
						</li>
						<li>
							<span>需求量</span>
							<span>1000</span>
						</li>
					</ul>
					-->
				</div>
			</div>
		
		
		
	</div><!-- /.modal-dialog -->
	
	</div>
		<!-- <div class="modal-footer">
				<button type="button" class="btn  btn-primary" >
					确认
				</button>
				<button type="button"  data-dismiss="modal"  class="btn btn-default">
					取消
		</button> -->
		</div><!-- /.modal-content -->
</div>
</div>
</div>

<div id="uploadFile">
									<form id="salepad" action="" enctype="">
										<div>
											<span style="display:none;">文件路径</span>
											<input style="display:none;" class="idkey" type="text" name="key" value="">
											<span style="display:none;">OSSAccessKeyId</span>
											<input style="display:none;" class="idOSSAccessKeyId" type="text" name="OSSAccessKeyId" value="">
											<span style="display:none;">policy</span>
											<input style="display:none;" class="idpolicy" type="text" name="policy" value="">
											
											<input style="display:none;" class="status" type="text" name="success_action_status" value="200">   
											<!-- value=200 成功时返回200,默认204 -->
											

											<span style="display:none;">Signature</span>
											<input style="display:none;" class="idSignature" type="text" name="Signature" value="">
											
											<input style="display:none;" name="file" type="file" class="file" accept="application/zip,.rar,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet">
										</div>
									</form>
								</div>
<div class="modal fade" id="loading" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" data-backdrop='static'>
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title" id="myModalLabel">提示</h4>
      </div>
      <div class="modal-body">
        请稍候。。。
      </div>
    </div>
  </div>
</div>
<script>

$('#start_date').datetimepicker({
	language:  'zh-CN',
	weekStart: 1,
    todayBtn:  1,
    autoclose: 1,
    todayHighlight: 1,
    startView: 2,
    minView: 2,
    forceParse: 0,
    format: 'yyyy-mm-dd'
    // startDate:new Date(),
}).on("click",function(ev){
			$("#startDate").datetimepicker("setEndDate", $("#end_date").val());
		});



$('#end_date').datetimepicker({
	language:  'zh-CN',
	weekStart: 1,
    todayBtn:  1,
    autoclose: 1,
    todayHighlight: 1,
    startView: 2,
    minView: 2,
    forceParse: 0,
    format: 'yyyy-mm-dd'
    // startDate:new Date(),
}).on("click",function(ev){
			$("#end_date").datetimepicker("setStartDate", $("#start_date").val());
		});
/*新增行业*/
$("#end_date,#start_date").click(function(){
	$("#times").hide()
})
function Add(type,data){
	
	if(type=="add"){
		$("#down").hide()
		$(".info_order .ID").find("span").hide();
		$("#start_date").val("")
		$("#end_date").val("")

	}else{
		$("#down").attr("href","https://res.mshuoke.com/"+data.censusRecordingUrl).show()
		$(".ID>span").html(data.id).show();
		$("#ifupload02").hide();
		$("#ifupload02").attr("path",data.censusRecordingUrl)
		$("#start_date").val(data.censusdayrange.split("~")[0])
		$("#end_date").val(data.censusdayrange.split("~")[1])

	}
	$("#_Container_0").show();
	$(".cover").show();
}

$(".cancel").click(function(){
	close()
})

function close(){
	$("#_Container_0").hide();
	$(".cover").hide();
}
function save(){
	var type=$(".ID>span").css("display");
	if(!$("#end_date").val()){
		$("#times").show()
		return;
	}
	if($("#ifupload02").attr("key")!=1&&type=="none"){
		$("#ifupload02").html("请上传文件")
		return ;
	}
	var addUrl=`https://gateway.mshuoke.com/pasf/itaudio`;
	var updateUrl=`https://gateway.mshuoke.com/pasf/it`;
	var sendData=JSON.stringify({
		  "ordername": addData.demandname,
		  "pid": addData.pid,
		  "jfuid":jfuid||30,
		  "censusRecordingUrl": $("#ifupload02").attr("path"),
		  "compname":addData.pid,
		  "censusdayrange":$("#start_date").val()+"~"+$("#end_date").val()
		})
	var updateData=JSON.stringify({
		  "censusdayrange":$("#start_date").val()+"~"+$("#end_date").val(),
		  "censusRecordingUrl": $("#ifupload02").attr("path"),
		  "stid":$(".ID>span").html().trim()
	})

	$.ajax({
		url:type=="none"?addUrl:updateUrl,
		type:type=="none"?"post":"patch",
		contentType: "application/json",
		data:type=="none"?sendData:updateData,
		success:function(result){
			if(result.code==0){
				close();
				location.reload()
			}
		},error:function(err){
			console.log(err)
		}
	})
}

//设定新增面板参数
var addData=JSON.parse(decodeURI( location.search.split("=")[1]));
var lis=$(".info_order").find("ul>li")
lis.eq(0).find("span").html(addData.pid)
lis.eq(1).find("span").html(addData.demandname)
lis.eq(2).find("span").html(addData.demandquantity)

//从cookie获取jfuid  userid
 var cookies=document.cookie.split(";");
 var userid;
 var jfuid;
for (var i = 0; i < cookies.length; i++) {
			 	if(cookies[i].split("=")[0].replace(/\s/g,"")=="userid"){
					userid=cookies[i].split("=")[1].replace(/\s/g,"")
			 	}if(cookies[i].split("=")[0].replace(/\s/g,"")=="jfuid"){
					jfuid=cookies[i].split("=")[1].replace(/\s/g,"")
			 	}
			 }



var $table = $('#table');
	//debugger;
	//文档地址http://bootstrap-table.wenzhixin.net.cn/zh-cn/documentation/
/*自定义头部*/

/*自己填写数据*/


$('#table').on('search.bs.table',function (){
	//debugger;
	var $search = $('.search input').eq(1);
	//debugger;
	//$search.off('keyup drop blur').on('keyup drop blur')();
});
//GET 开发完成 /pasf/csusers/{csuserid}/auditedworkers
// var url = domain137 + '/csusers/'+roleid+'/auditedworkers';
var url=`https://gateway.mshuoke.com/pasf/itaudios?pid=${addData.pid}`
$('#table').bootstrapTable({
	 url:url,
	 pagination: true, //分页
	 contentType:'application/json',
     search:true,
	 showColumns:true,
	 searchAlign:'left',
	 checkbox:false,
	searchOnEnterKey:true,
	 queryParams:function (params){
			 /*自定义参数,如果有参数在这里定义*/
			  var data = {all:ifAll};

			   data.size = 100000000;
	   return  data;
	 },
	 sidePagination: "client",
	 responseHandler:function(res){
				//console.log(JSON.stringify(res));
				
				/*"total": 800,*/
				// var newJson = {};
				// newJson.total = '800';
				// newJson.data = res.data;
				//debugger;
				//res.rows = res.list;
                // return newJson;
				if(res.code==0){
					res.data.map(v=>{
						v.compname=addData.companyname
						v.demandname=addData.demandname
						v.demandquantity=addData.demandquantity
						v.csstatus=v.csstatus==1?"通过":"不通过";
						v.data=JSON.stringify({
							id:v.stid,
							demandname:addData.demandname,
							demandquantity:addData.demandquantity,
							censusRecordingUrl:v.censusRecordingUrl,
							censusdayrange:v.censusdayrange
						})
					})
					return res.data
				}
				
				return res 



     },
	 onLoadSuccess(){
		
		
		
		/*移动自带事件*/
		$('.search-btn button').click(function(){
			$('.search input').eq(1).val($('.search input').eq(0).val());
			$('.search input').eq(1).keyup();
		});
		//debugger;
		
		/*当search 没有vlaue的时候*/
		$('.search input').eq(0)[0].oninput= function (){
			if(!this.value){
				$('.search input').eq(1).val(this.value);
				$('.search input').eq(1).keyup();
			}
		};
		
		
		$('.search input').eq(0).keyup(function (ev){
			
			var oEvent = ev || event;
			if(oEvent.keyCode==13){
				$('.search input').eq(1).val(this.value);
				$('.search input').eq(1).keyup();
			}
		});
	 },
	 formatNoMatches:function(){
         return '没有搜索结果'
     },
     formatLoadingMessage:function(){
          return '没有搜索结果';
     },
	 columns: [{  
          field: 'compname',  
          title: '发包方公司名称'  
        }, {  
          field: 'demandname',  
          title: '需求名称'  
        }, {  
          field: 'demandquantity',  
          title: '需求量'  
        },{  
          field: 'createtime',  
          title: '发布时间'  
        },{  
          field: 'censusRecordingUrl',  
          title: '录音文件' ,
           formatter:function(path){
            return `<a style="color: #337ab7;text-decoration:none;cursor:pointer;" href=https://res.mshuoke.com/${path}>下载</a>`
        }
        },{  
          field: 'csstatus',  
          title: '状态'  
        },{  
          field: 'createtime',  
          title: '上传时间'  
        },{  
    	title:"操作",
        class:"handle1",
        formatter:function(data){
            return `<a class="btn btn-xs btn-success" onclick=Add("edit",${data})><i class="ace-icon fa fa-pencil-square-o bigger-120"></i></a>`
        },
        field:"data",
        visible: true,
        align: 'center',
        valign: 'middle'
        }
	]  
		
});

/*
$('.btn-success.search2').click(function (){
	$('#table').bootstrapTable('refresh');
});
*/

	
var newDate = new Date();
var time = newDate.toJSON();
 $(".start_date")
 .datetimepicker({
		language:  'zh-CN',
		 weekStart: 1,
		 todayBtn:  1,
		 autoclose: 1,
		 todayHighlight: 1,
		 startView: 2,
		 minView: 2,
		 forceParse: 0,
		 format: 'yyyy-mm-dd',
		 startDate:new Date(time),
}).on("click",function(ev){
		$(".start_date").datetimepicker("setEndDate", $(".end_date").val());
}).on("change",function(ev){
	$(".startDate").html($(".start_date").val());
	$(".start_date").blur();
}).on("blur",function(ev){
	if(isNull($(".start_date").val())){
		$(this).parent().find("p.error").eq(0).show();
	}else{
		$(this).parent().find("p.error").eq(0).hide();
	}
});
					
$(".end_date")
.datetimepicker({
			language:  'zh-CN',
				 weekStart: 1,
				 todayBtn:  1,
				 autoclose: 1,
				 todayHighlight: 1,
				 startView: 2,
				 minView: 2,
				 forceParse: 0,
				 format: 'yyyy-mm-dd',
}).on("click", function (ev) {
		$(".end_date").datetimepicker("setStartDate", $(".start_date").val());
}).on("change",function(ev){
$(".endDate").html($(".end_date").val());
$(".end_date").blur();
}).on("blur",function(ev){
	if(isNull($(".end_date").val())){
		$(this).parent().find("p.error").eq(1).show();
	}else{
		$(this).parent().find("p.error").eq(1).hide();
	}
});
//------------------录音上传--------------------------
$("#upload02").click(function(){
		$(".file")[0].onchange=function () {
				var typeArr = ['image/jpeg','image/png','image/bmp'];//限制文件格式
				var fileInfo=this.files[0];		
				// console.log(fileInfo)
				// if(typeArr.indexOf(fileInfo.type)=="-1"){
				// 	return ;
				// }
				// if((fileInfo.size/1024)>3072){			//限制大小
				// 	return ;
				// }


			resultSignature =  JSON.parse(getSignature({fileName:'record'}));
				/*设置签名信息*/
			$('#salepad')[0].action = resultSignature.host;
			$("#uploadFile").find('.idkey').val(resultSignature.dir+'${filename}');
			$("#uploadFile").find('.idpolicy').val(resultSignature.policy);
			$("#uploadFile").find('.idOSSAccessKeyId').val(resultSignature.accessid);
			$("#uploadFile").find('.idSignature').val(resultSignature.signature);
				var filename=/\s|\+|\!|\@|\@|\#|\$|\%|\^|\&|\*|\(|\)|\=|\-|\_/g.test(fileInfo.name)
				if(filename){
					$("#ifupload02").html("上传成功失败,文件名包含非法字符或空格").attr("key","0")
					return ;
				}
				var _path=/*"https://res.mshuoke.com/"*/resultSignature.dir+fileInfo.name;
				uploadByForm($('#salepad')[0],"https://mso.oss-cn-shanghai.aliyuncs.com",fileInfo.name,_path);//上传方法

		}
		return $(".file").click();
})

//获取签名信息
function getSignature(parm){
		if(!parm){
			return;
		}
		
		if(!parm.fileName){
			return;
		}
		var xmlhttp = null;
		if (window.XMLHttpRequest){
			xmlhttp=new XMLHttpRequest();
		}else if (window.ActiveXObject){
			xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
		}

		if (xmlhttp){
		  
			var credentials = parm.fileName;
			/*后台签名上传*/
			 //https://back.mshuoke.com/aliOrder/customerDelve.do?stid=undefined&type=fbxq  
			 if(!userid){
			 	console.log("没有userid")
			 	return 
			 }

			 serverUrl=`https://back.mshuoke.com/aliOrder/census.do?stid=${userid}&type=${credentials}/aliOrder`
			// serverUrl = serverUrlpre +'/ali.do?uid='+roleid+'&type='+credentials;
		   
			xmlhttp.open( "GET", serverUrl, false );
			xmlhttp.send( null );
			return xmlhttp.responseText
		}else{
			alert("Your browser does not support XMLHTTP.");
		}
	}
function uploadByForm(Form,host,filename,path) {
	  /*模拟二进制流*/
	  var formData = new FormData(Form);
	 // oMyForm.append("username", "Groucho");
	 // var url = "https://mso.oss-cn-shanghai.aliyuncs.com"; 
		$.ajax({  
				beforeSend:function(){
					$("#loading").modal("show")
				},
				url:host,  
				type:'POST', 
				processData : false,  
				contentType : false, 
				data:formData,
				success(){
					$("#ifupload02").html("上传成功 文件名:"+filename).attr("key","1").attr("path",path).show()
				},
				error:function(err){
					console.log(err);
					$("#ifupload02").html("上传文件失败").attr("key","0").show()
				},
				complete:function(){
					$("#loading").modal("hide")
				}
			})





}

</script>

</body>
</html>